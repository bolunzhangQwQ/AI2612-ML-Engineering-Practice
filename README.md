# AI2612-ML-Engineering-Practice
# SimSwap换脸模型分析与优化项目
本项目旨在深入分析并改进现有的[SimSwap换脸模型](https://github.com/neuralchen/SimSwap)，通过一系列创新的技术手段，提高模型的换脸效果质量和稳定性。同时，项目还涉及对AI换脸技术伦理问题的探讨，以及对未来发展前景的展望。

## 目录
1. [摘要](#摘要)
2. [引言](#引言)
3. [SimSwap模型](#simswap模型)
4. [改进方法](#改进方法)
   - [引入Mask](#引入mask)
   - [优化卷积层网络](#优化卷积层网络)
   - [模仿diffusion调整id注入](#模仿diffusion调整id注入)
5. [数据集清洗](#数据集清洗)
6. [伦理之忧与未来展望](#伦理之忧与未来展望)
7. [个人贡献](#个人贡献)
8. [参考文献](#参考文献)
9. [贡献](#贡献)
10. [负责人](#负责人)

## 摘要
本项目首先分析了SimSwap模型存在的问题，包括训练推理速度低和生成图像自然性不足等。针对这些问题，提出了包括引入mask、优化卷积层网络结构、模仿diffusion改进id注入等改进方案。同时，项目还对AI换脸技术的伦理问题进行了深入讨论，并提出了相应的解决方案。

## 引言
随着深度学习技术的不断进步，AI换脸技术作为图像编辑领域的一个重要分支，已经引起了广泛的关注。SimSwap模型作为其中的代表性成果，虽然取得了显著的成就，但仍存在一些亟待解决的问题。

## SimSwap模型
### 简介
SimSwap是一个高效的面部交换框架，能够实现高保真的换脸效果。该模型由生成器和判别器组成，生成器负责生成换脸图像，判别器则用于评估生成图像的真实性。

### 问题和缺陷
当前SimSwap模型的主要问题在于训练推理速度较低，且生成的人脸图像有时不够自然。此外，模型在id注入模块上存在瓶颈，需要进一步优化。

## 改进方法
### 引入Mask
通过引入mask技术，可以减少背景对训练过程的影响，提高模型性能。

#### 基于ResNet的人脸检测
使用预训练的ResNet模型进行人脸检测，生成mask以分离人脸和背景。

#### 基于Deeplabv3+的图像分割
利用Deeplabv3+模型进行更精细的图像分割，以进一步提升mask的质量。

### 优化卷积层网络
针对生成器部分的卷积层进行优化，以减少模型的推理时间并改善输出效果。

#### 深度可分离卷积
减少参数数量和计算复杂度，加速模型运算。

#### 动态卷积
动态调整卷积核权重，以更好地捕捉数据中的动态模式。

#### 调制卷积
引入可学习的调制信号，动态调整卷积核的权重。

### 模仿diffusion调整id注入
借鉴diffusion model的思路，逐步实现id信息的注入和换脸效果的生成。

## 数据集清洗
对VGGFace2数据集进行清洗，移除模糊失真和非目标类别的图片，提高数据集质量。

## 伦理之忧与未来展望
### 伦理之忧
AI换脸技术可能引发隐私侵犯、虚假信息传播等一系列伦理问题。项目提出了包括AIGC水印在内的解决方案，以保护个人隐私并防止滥用。

### 未来展望
展望AI换脸技术的未来发展，预计会有更多创新技术的出现，同时也需要法律和监管的跟进，以确保技术的健康发展。

## 个人贡献
  ### 张博伦

- **数据清洗与预处理**：负责初步的数据清洗工作，确保数据集的质量，为后续模型训练打下坚实基础。这包括移除VGGFace2数据集中的模糊、失真图片，以及将sjtu数据集从png格式转换为jpg格式，以提高训练效率。

- **SimSwap算法基线实现**：成功运行了SimSwap算法的基线版本，为后续的改进工作提供了基准性能和参考实现。

- **深度可分离卷积、动态卷积、调制卷积改进实现**：探索并实现了多种卷积层优化技术，以减少模型的推理时间并提升生成图像的质量。这包括深度可分离卷积、动态卷积和调制卷积的集成与测试。

- **性能测试与评估**：编写了ArcFace余弦距离测试脚本，对改进后的模型进行了性能评估，确保了改进措施的有效性。

- **AIGC水印技术研究与集成**：针对AI换脸技术的伦理问题深入研究了现有的AIGC水印技术，为换脸后的图片添加了难以察觉但机器可识别的水印，以防止滥用和侵权。

- **技术文档与报告撰写**：负责撰写项目报告中与自己工作相关部分的内容，详细记录了实验过程、结果分析。

- **项目管理与协调**：在项目进展中还承担了项目管理和协调的角色，确保项目按计划进行，并促进团队成员间的有效沟通。

## 参考文献
项目中引用的文献包括SimSwap原始论文、Deeplabv3+论文、深度可分离卷积论文等。详见PDF

## 贡献
本项目为AI换脸技术的发展提供了新的视角和改进方案，同时对伦理问题的探讨也为该领域的健康发展提供了参考。

## 负责人
张博伦 联系方式：zbl15947161883@sjtu.edu.cn
